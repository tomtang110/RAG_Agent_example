<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simple Agent RAG for Basketball Player Information</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 40px;
      line-height: 1.8;
      color: #333;
      background-color: #f9f9f9;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #007acc;
      padding-bottom: 15px;
    }
    .lang-switch {
      position: absolute;
      top: 20px;
      right: 20px;
    }
    button {
      background-color: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 0 5px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #005a99;
    }
    .content {
      margin-top: 20px;
    }
    .zh, .en {
      display: none;
    }
    .zh.active, .en.active {
      display: block;
      animation: fadeIn 0.5s ease-in-out;
    }
    h1, h2, h3 {
      color: #2c3e50;
    }
    h1 {
      font-size: 2.2em;
      margin-bottom: 10px;
    }
    h2 {
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
      margin-top: 30px;
      color: #007acc;
    }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      color: #d63384;
    }
    pre {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      border: 1px solid #e9ecef;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 12px;
      text-align: left;
    }
    th {
      background-color: #007acc;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    .note {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
      font-style: italic;
    }
    .future {
      background-color: #d1ecf1;
      border-left: 4px solid #17a2b8;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    .footer {
      margin-top: 50px;
      text-align: center;
      font-size: 14px;
      color: #6c757d;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .logo {
      color: #007acc;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="lang-switch">
        <button onclick="setLang('zh')">ä¸­æ–‡</button>
        <button onclick="setLang('en')">English</button>
      </div>
      <h1><span class="logo">ğŸ€ Agent RAG</span> - ç¯®çƒè¿åŠ¨å‘˜ä¿¡æ¯é—®ç­”ç³»ç»Ÿ</h1>
      <p>A Simple RAG System for Basketball Player Information</p>
    </div>

    <div class="content">
      <!-- ä¸­æ–‡å†…å®¹ -->
      <div id="zh" class="zh active">
        <h2>é¡¹ç›®ç®€ä»‹</h2>
        <p>æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªç®€å•çš„ <strong>Agent RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿ</strong>ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…å’Œç ”ç©¶è€…ç†è§£å¦‚ä½•æ„å»ºä¸€ä¸ªé¢†åŸŸä¸“ç”¨çš„é—®ç­”ç³»ç»Ÿã€‚å½“å‰ç³»ç»Ÿä¸“æ³¨äº <strong>ç¯®çƒç›¸å…³é—®é¢˜</strong>ï¼Œæ•°æ®æ¶µç›– <strong>ä¸­å›½å’Œç¾å›½å„å‰50åç¯®çƒè¿åŠ¨å‘˜çš„æ¦‚è§ˆä¿¡æ¯</strong>ã€‚</p>
        <p>ç³»ç»Ÿé›†æˆäº†è·¯ç”±ã€åµŒå…¥æ£€ç´¢ï¼ˆEmbeddingï¼‰ã€BM25ã€ç”Ÿæˆç­‰æ ¸å¿ƒæ¨¡å—ï¼Œæ˜¯å­¦ä¹  RAG æ¶æ„çš„ç†æƒ³å®è·µé¡¹ç›®ã€‚</p>

        <h2>ğŸ“š æ•°æ®é›†è¯´æ˜</h2>
        <p>ç³»ç»ŸåŸºäºä»¥ä¸‹ä¸¤ä¸ª Excel æ•°æ®æ–‡ä»¶æ„å»ºï¼š</p>
        <ul>
          <li><code>america_basketball_player.xlsx</code>ï¼šç¾å›½å‰50åç¯®çƒè¿åŠ¨å‘˜çš„ç»¼åˆä¿¡æ¯</li>
          <li><code>china_basketball_player.xlsx</code>ï¼šä¸­å›½å‰50åç¯®çƒè¿åŠ¨å‘˜çš„ç»¼åˆä¿¡æ¯</li>
        </ul>
        <div class="note">
          âš ï¸ <strong>æ³¨æ„</strong>ï¼šæœ¬ç³»ç»Ÿ<strong>ä»…æ”¯æŒç¯®çƒç›¸å…³æŸ¥è¯¢</strong>ï¼Œå…¶ä»–é¢†åŸŸé—®é¢˜å°†è¢«æ‹’ç»ã€‚
        </div>

        <h2>ğŸ§± ç³»ç»Ÿæ¶æ„</h2>
        <p>Agent RAG æµç¨‹åŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š</p>
        <table>
          <tr>
            <th>æ¨¡å—</th>
            <th>åŠŸèƒ½è¯´æ˜</th>
          </tr>
          <tr>
            <td><strong>Routerï¼ˆè·¯ç”±ï¼‰</strong></td>
            <td>åˆ¤æ–­ç”¨æˆ·é—®é¢˜æ˜¯å¦ä¸ç¯®çƒç›¸å…³ï¼Œè¿‡æ»¤æ— å…³è¯·æ±‚</td>
          </tr>
          <tr>
            <td><strong>Retrieverï¼ˆæ£€ç´¢å™¨ï¼‰</strong></td>
            <td>èåˆ <strong>å‘é‡æ£€ç´¢ï¼ˆEmbeddingï¼‰</strong> ä¸ <strong>å…³é”®è¯æ£€ç´¢ï¼ˆBM25ï¼‰</strong>ï¼Œæå‡å¬å›å‡†ç¡®ç‡</td>
          </tr>
          <tr>
            <td><strong>Generatorï¼ˆç”Ÿæˆå™¨ï¼‰</strong></td>
            <td>åŸºäºæ£€ç´¢ç»“æœï¼Œè°ƒç”¨å¤§æ¨¡å‹ç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”</td>
          </tr>
        </table>
        <div class="future">
          ğŸ”§ <strong>åç»­è®¡åˆ’</strong>ï¼šå°†é€æ­¥åŠ å…¥æŸ¥è¯¢æ”¹å†™ã€é‡æ’åºï¼ˆrerankerï¼‰ã€ç½‘ç»œæœç´¢ç­‰é«˜çº§æ¨¡å—ã€‚
        </div>

        <h2>ğŸ› ï¸ ä¾èµ–åº“</h2>
        <p>é¡¹ç›®ä¾èµ–ä»¥ä¸‹æ ¸å¿ƒåº“å’ŒæœåŠ¡ï¼š</p>
        <ul>
          <li><code>qwen</code> â€“ ä½¿ç”¨é€šä¹‰åƒé—® API è¿›è¡Œæ–‡æœ¬åµŒå…¥å’Œç”Ÿæˆ</li>
          <li><code>langchain</code> â€“ æ„å»º LLM åº”ç”¨çš„æ ¸å¿ƒæ¡†æ¶</li>
          <li><code>langgraph</code> â€“ ç”¨äºæ„å»º Agent çŠ¶æ€æµå’Œå·¥ä½œæµ</li>
          <li><code>pydantic</code> â€“ æ•°æ®æ ¡éªŒä¸é…ç½®ç®¡ç†</li>
          <li><code>pandas</code> â€“ è¯»å–å’Œå¤„ç† Excel æ•°æ®</li>
          <li><code>openpyxl</code> â€“ æ”¯æŒ <code>.xlsx</code> æ–‡ä»¶è¯»å–</li>
          <li>å…¶ä»–å¸¸ç”¨åº“ï¼š<code>tqdm</code>, <code>numpy</code> ç­‰</li>
        </ul>
        <p>å®‰è£…ä¾èµ–ï¼š</p>
        <pre><code>pip install -r requirements.txt</code></pre>
        <div class="note">
          ğŸ’¡ éœ€æå‰é…ç½® <strong>Qwen API Key</strong>ï¼ˆå»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®ï¼‰
        </div>

        <h2>ğŸ“ é¡¹ç›®ç»“æ„</h2>
        <pre>
.
â”œâ”€â”€ main.py                   # ä¸»ç¨‹åºå…¥å£ï¼šå®ç°å®Œæ•´çš„ RAG æµç¨‹
â”œâ”€â”€ models.py                 # å®šä¹‰åµŒå…¥æ¨¡å‹å’Œç”Ÿæˆæ¨¡å‹çš„ API æ¥å£
â”œâ”€â”€ prompt_set.py             # åŒ…å«è·¯ç”±å’Œç”Ÿæˆé˜¶æ®µçš„æç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ utils.py                  # å·¥å…·å‡½æ•°ï¼Œå¦‚æ•°æ®è§£æã€æ ¼å¼å¤„ç†ç­‰
â”œâ”€â”€ america_basketball_player.xlsx  # ç¾å›½çƒå‘˜æ•°æ®é›†
â”œâ”€â”€ china_basketball_player.xlsx    # ä¸­å›½çƒå‘˜æ•°æ®é›†
â”œâ”€â”€ README.md / README_zh.md  # è¯´æ˜æ–‡æ¡£ï¼ˆä¸­è‹±æ–‡ï¼‰
â””â”€â”€ requirements.txt          # ä¾èµ–åˆ—è¡¨
        </pre>

        <h2>ğŸš€ ä½¿ç”¨æ–¹æ³•</h2>
        <ol>
          <li><strong>è®¾ç½® Qwen API Key</strong>ï¼š
            <pre><code>export QWEN_API_KEY="your_api_key_here"</code></pre>
          </li>
          <li><strong>è¿è¡Œä¸»ç¨‹åº</strong>ï¼š
            <pre><code>python main.py</code></pre>
          </li>
          <li><strong>è¾“å…¥é—®é¢˜ç¤ºä¾‹</strong>ï¼š
            <ul>
              <li>â€œä¸­å›½æ’åå‰ä¸‰çš„çƒå‘˜æ˜¯è°ï¼Ÿâ€</li>
              <li>â€œå‹’å¸ƒæœ—Â·è©¹å§†æ–¯æ•ˆåŠ›äºå“ªæ”¯çƒé˜Ÿï¼Ÿâ€</li>
              <li>â€œå§šæ˜çš„èº«é«˜å’ŒèŒä¸šç”Ÿæ¶¯å¾—åˆ†æ˜¯å¤šå°‘ï¼Ÿâ€</li>
            </ul>
          </li>
        </ol>
        <div class="note">
          âœ… ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ¤æ–­é—®é¢˜ç›¸å…³æ€§ï¼Œéç¯®çƒé—®é¢˜å°†è¢«ç¤¼è²Œæ‹’ç»ã€‚
        </div>

        <h2>ğŸ§ª ç¤ºä¾‹è¾“å‡º</h2>
        <p><strong>è¾“å…¥</strong>ï¼š
        â€œåˆ—å‡ºä¸­å›½å‰3åçƒå‘˜çš„èŒä¸šç”Ÿæ¶¯æ€»å¾—åˆ†â€</p>
        <p><strong>è¾“å‡º</strong>ï¼š
        æ ¹æ®æ•°æ®ï¼Œä¸­å›½å‰3åçƒå‘˜çš„èŒä¸šç”Ÿæ¶¯å¾—åˆ†å¦‚ä¸‹ï¼š<br>
        1. å§šæ˜ â€“ NBAä¸CBAåˆè®¡è¶…è¿‡9200åˆ†<br>
        2. æ˜“å»ºè” â€“ èŒä¸šç”Ÿæ¶¯ç´¯è®¡7500+åˆ†<br>
        3. éƒ­è‰¾ä¼¦ â€“ CBAæ ¸å¿ƒåå«ï¼Œå¾—åˆ†è¶…6000åˆ†</p>
        <div class="note">
          ï¼ˆæ³¨ï¼šå…·ä½“æ•°å€¼ä»¥å®é™…æ•°æ®é›†å†…å®¹ä¸ºå‡†ï¼‰
        </div>

        <h2>ğŸ“Œ å½“å‰é™åˆ¶</h2>
        <ul>
          <li>ä»…æ”¯æŒç¯®çƒé¢†åŸŸé—®é¢˜</li>
          <li>æš‚æ— æŸ¥è¯¢æ‰©å±•ã€é‡æ’åºç­‰é«˜çº§åŠŸèƒ½</li>
          <li>å›ç­”è´¨é‡ä¾èµ–æ•°æ®å®Œæ•´æ€§å’Œæ¨¡å‹èƒ½åŠ›</li>
        </ul>

        <h2>ğŸŒŸ åç»­ä¼˜åŒ–è®¡åˆ’</h2>
        <div class="future">
          <ul>
            <li>[ ] æ·»åŠ  <strong>æŸ¥è¯¢æ”¹å†™ï¼ˆQuery Rewritingï¼‰</strong> æå‡å¬å›ç‡</li>
            <li>[ ] é›†æˆ <strong>é‡æ’åºæ¨¡å‹ï¼ˆRerankerï¼‰</strong> æé«˜ç»“æœç›¸å…³æ€§</li>
            <li>[ ] æ”¯æŒ <strong>ç½‘ç»œæœç´¢æ‰©å±•</strong>ï¼Œåº”å¯¹æœªçŸ¥çŸ¥è¯†</li>
            <li>[ ] æ‰©å±•è‡³æ›´å¤šä½“è‚²é¡¹ç›®æˆ–é€šç”¨é¢†åŸŸ</li>
          </ul>
        </div>

        <h2>ğŸ™Œ è‡´è°¢</h2>
        <ul>
          <li><a href="https://langchain.com" target="_blank">LangChain</a> ä¸ <a href="https://langchain-ai.github.io/langgraph/" target="_blank">LangGraph</a> â€“ å¼ºå¤§çš„æµç¨‹ç¼–æ’å·¥å…·</li>
          <li><a href="https://qwen.ai" target="_blank">é€šä¹‰åƒé—® Qwen</a> â€“ æä¾›é«˜è´¨é‡çš„ LLM API æ”¯æŒ</li>
        </ul>

        <h2>ğŸ“„ è®¸å¯è¯</h2>
        <p>MIT Licenseï¼Œè¯¦è§ <code>LICENSE</code> æ–‡ä»¶ã€‚</p>
      </div>

      <!-- è‹±æ–‡å†…å®¹ -->
      <div id="en" class="en">
        <h2>Project Overview</h2>
        <p>This repository provides a simple <strong>Agent RAG (Retrieval-Augmented Generation)</strong> system designed to help practitioners understand the foundational components of building a domain-specific question-answering system. The current implementation focuses exclusively on <strong>basketball-related queries</strong>, specifically information about the <strong>top 50 Chinese and American basketball players</strong>.</p>
        <p>This project is ideal for learning how to integrate core RAG components such as routing, retrieval (embedding + BM25), and generation using modern LLM tooling.</p>

        <h2>ğŸ“š Dataset Overview</h2>
        <p>The system is trained on two datasets:</p>
        <ul>
          <li><code>america_basketball_player.xlsx</code>: Overview of the top 50 American basketball players</li>
          <li><code>china_basketball_player.xlsx</code>: Overview of the top 50 Chinese basketball players</li>
        </ul>
        <div class="note">
          âš ï¸ <strong>Note</strong>: The RAG system currently <strong>only supports basketball-related queries</strong> due to the limited scope of the dataset.
        </div>

        <h2>ğŸ§± System Architecture</h2>
        <p>The Agent RAG pipeline includes the following core modules:</p>
        <table>
          <tr>
            <th>Module</th>
            <th>Description</th>
          </tr>
          <tr>
            <td><strong>Router</strong></td>
            <td>Determines if the query is basketball-related. If not, it returns a rejection response.</td>
          </tr>
          <tr>
            <td><strong>Retriever</strong></td>
            <td>Combines <strong>dense retrieval (embedding-based)</strong> and <strong>sparse retrieval (BM25)</strong> for robust document lookup.</td>
          </tr>
          <tr>
            <td><strong>Generator</strong></td>
            <td>Uses a large language model to generate natural language responses based on retrieved context.</td>
          </tr>
        </table>
        <div class="future">
          ğŸ”§ <strong>Future Enhancements</strong>: Support for query rewriting, reranking, and web search will be added in upcoming versions.
        </div>

        <h2>ğŸ› ï¸ Dependencies</h2>
        <p>This project relies on the following key libraries and services:</p>
        <ul>
          <li><code>qwen</code> â€“ Alibaba's Qwen API for LLM inference (used for generation and embeddings)</li>
          <li><code>langchain</code> â€“ Framework for building LLM-powered applications</li>
          <li><code>langgraph</code> â€“ For orchestrating agent workflows and state management</li>
          <li><code>pydantic</code> â€“ Data validation and settings management</li>
          <li><code>pandas</code> â€“ For loading and processing Excel datasets</li>
          <li><code>openpyxl</code> â€“ Required for reading <code>.xlsx</code> files</li>
          <li>Other standard utilities: <code>tqdm</code>, <code>numpy</code>, etc.</li>
        </ul>
        <p>Install dependencies:</p>
        <pre><code>pip install -r requirements.txt</code></pre>
        <div class="note">
          ğŸ’¡ You must have access to the <strong>Qwen API</strong> and configure your API key (e.g., via environment variables).
        </div>

        <h2>ğŸ“ Project Structure</h2>
        <pre>
.
â”œâ”€â”€ main.py                   # Entry point: Implements the full RAG pipeline
â”œâ”€â”€ models.py                 # Defines the embedding and generation APIs using Qwen
â”œâ”€â”€ prompt_set.py             # Contains prompts for router and generator
â”œâ”€â”€ utils.py                  # Utility functions for parsing and data processing
â”œâ”€â”€ america_basketball_player.xlsx  # Dataset: Top 50 American players
â”œâ”€â”€ china_basketball_player.xlsx    # Dataset: Top 50 Chinese players
â”œâ”€â”€ README.md / README_zh.md  # This file
â””â”€â”€ requirements.txt          # Python dependencies
        </pre>

        <h2>ğŸš€ Usage</h2>
        <ol>
          <li><strong>Set up your Qwen API key</strong>:
            <pre><code>export QWEN_API_KEY="your_api_key_here"</code></pre>
          </li>
          <li><strong>Run the main application</strong>:
            <pre><code>python main.py</code></pre>
          </li>
          <li><strong>Ask a question</strong>:
            <ul>
              <li>"Who is the tallest player in the Chinese top 50?"</li>
              <li>"What team does the number 1 ranked American player play for?"</li>
              <li>"What are Yao Ming's height and career points?"</li>
            </ul>
          </li>
        </ol>
        <div class="note">
          âœ… Only basketball-related questions will be processed. All others will be filtered by the router.
        </div>

        <h2>ğŸ§ª Example Output</h2>
        <p><strong>Input</strong>:
        "List the top 3 Chinese basketball players by career points."</p>
        <p><strong>Output</strong>:
        Based on the dataset, the top 3 Chinese basketball players by career points are:<br>
        1. Yao Ming â€“ 9,200+ points in the NBA and CBA combined<br>
        2. Yi Jianlian â€“ Over 7,500 professional points<br>
        3. Guo Ailun â€“ Key guard with over 6,000 CBA points</p>
        <div class="note">
          *(Note: Actual stats depend on dataset content)*
        </div>

        <h2>ğŸ“Œ Limitations</h2>
        <ul>
          <li>Domain-specific: Only answers questions related to the provided basketball datasets.</li>
          <li>No query expansion or advanced reranking yet.</li>
          <li>Performance depends on the quality of the input data and embedding model.</li>
        </ul>

        <h2>ğŸŒŸ Future Work</h2>
        <div class="future">
          <ul>
            <li>[ ] Add <strong>query revision</strong> module to improve retrieval accuracy</li>
            <li>[ ] Integrate a <strong>reranker</strong> (e.g., BERT-based) to improve result relevance</li>
            <li>[ ] Enable <strong>web search fallback</strong> for out-of-dataset queries</li>
            <li>[ ] Support for more sports and broader domains</li>
          </ul>
        </div>

        <h2>ğŸ™Œ Acknowledgments</h2>
        <ul>
          <li><a href="https://langchain.com" target="_blank">LangChain</a> & <a href="https://langchain-ai.github.io/langgraph/" target="_blank">LangGraph</a> â€“ For powerful orchestration tools</li>
          <li><a href="https://qwen.ai" target="_blank">Alibaba Cloud Qwen</a> â€“ For providing state-of-the-art LLM APIs</li>
        </ul>

        <h2>ğŸ“„ License</h2>
        <p>MIT License. See <code>LICENSE</code> for details.</p>
      </div>
    </div>

    <div class="footer">
      <p>ğŸ¤– Built with â¤ï¸ by Qwen | Alibaba Cloud | For educational and research purposes only.</p>
    </div>
  </div>

  <script>
    function setLang(lang) {
      document.querySelectorAll('.zh, .en').forEach(el => el.classList.remove('active'));
      document.getElementById(lang).classList.add('active');
      // Optional: Save preference
      localStorage.setItem('preferred-lang', lang);
    }

    // Auto-detect language preference
    window.onload = function() {
      const savedLang = localStorage.getItem('preferred-lang');
      const userLang = navigator.language || navigator.userLanguage;
      if (savedLang) {
        setLang(savedLang);
      } else if (userLang.startsWith('zh')) {
        setLang('zh');
      } else {
        setLang('en');
      }
    }
  </script>
</body>
</html>